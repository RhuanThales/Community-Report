window.setImmediate||function(){var e=0;var d={};var f=true;var g=Array.prototype.slice;var i="setImmediatePolyfillMessage";function a(j){var k=j[0];switch(j.length){case 1:return k();case 2:return k(j[1]);case 3:return k(j[1],j[2])}return k.apply(window,g.call(j,1))}function h(k){var j=k.data;var l;if(typeof j=="string"&&j.indexOf(i)==0){l=d[j];if(l){delete d[j];a(l)}}}window.setImmediate=function c(){var m=e++;var l=i+m;var k=arguments.length;var j=new Array(k);while(k--){j[k]=arguments[k]}d[l]=j;if(f){f=false;window.addEventListener("message",h)}window.postMessage(l,"*");return m};window.clearImmediate=function b(j){delete d[i+j]}}();(function(u){var g="[[PromiseStatus]]";var h="[[PromiseValue]]";var j="[[OnFulfilled]]";var a="[[OnRejected]]";var t="[[OriginalError]]";var i="pending";var m="internal pending";var c="fulfilled";var B="rejected";var b="not an array.";var y='constructor Promise requires "new".';var e="then() cannot return same Promise that it resolves.";var v=u.setImmediate||require("timers").setImmediate;var n=Array.isArray||function(F){return Object.prototype.toString.call(F)=="[object Array]"};function o(F){this[t]=F}function z(F){return F instanceof o}function l(F){return Object(F)===F}function q(F){return typeof F=="function"}function p(F){return F instanceof d}function E(F){return F}function x(F){throw F}function s(H,G,F){if(!H[j]){H[j]=[];H[a]=[]}H[j].push(G);H[a].push(F)}function D(F){delete F[j];delete F[a]}function C(F){var G;var H=F.length;for(G=0;G<H;G++){F[G]()}}function w(I,H,G){var F=k(G);if(p(F)){F.then(I,H)}else{if(z(F)){H(F[t])}else{I(G)}}}function k(G){var H;if(p(G)){return G}if(l(G)){try{H=G.then}catch(F){return new o(F)}if(q(H)){return new d(function(J,I){v(function(){try{H.call(G,J,I)}catch(K){I(K)}})})}}return null}function f(J,I){function H(K){if(J[g]==i){r(J,K)}}function G(K){if(J[g]==i){A(J,K)}}try{I(H,G)}catch(F){G(F)}}function r(I,H){var F;var G=k(H);if(p(G)){I[g]=m;G.then(function(J){r(I,J)},function(J){A(I,J)})}else{if(z(G)){A(I,G[t])}else{I[g]=c;I[h]=H;F=I[j];if(F&&F.length){D(I);C(F)}}}}function A(H,G){var F=H[a];H[g]=B;H[h]=G;if(F&&F.length){D(H);C(F)}}function d(G){var F=this;if(!p(F)){throw new TypeError(y)}F[g]=i;F[h]=undefined;f(F,G)}d.prototype.then=function(I,G){var H=this;var F;I=q(I)?I:E;G=q(G)?G:x;F=new d(function(L,K){function N(P){var Q;try{Q=P(H[h])}catch(O){K(O);return}if(Q===F){K(new TypeError(e))}else{w(L,K,Q)}}function M(){v(N,I)}function J(){v(N,G)}switch(H[g]){case c:M();break;case B:J();break;default:s(H,M,J)}});return F};d.prototype["catch"]=function(F){return this.then(E,F)};d.resolve=function(G){var F=k(G);if(p(F)){return F}return new d(function(I,H){if(z(F)){H(F[t])}else{I(G)}})};d.reject=function(F){return new d(function(H,G){G(F)})};d.race=function(F){return new d(function(J,I){var G;var H;if(n(F)){H=F.length;for(G=0;G<H;G++){w(J,I,F[G])}}else{I(new TypeError(b))}})};d.all=function(F){return new d(function(M,L){var G=0;var N=0;var I;var J;var K;var H;if(n(F)){F=F.slice(0);J=F.length;for(H=0;H<J;H++){K=F[H];I=k(K);if(p(I)){N++;I.then(function(O){return function(P){F[O]=P;G++;if(G==N){M(F)}}}(H),L)}else{if(z(I)){L(I[t])}else{F[H]=K}}}if(!N){M(F)}}else{L(new TypeError(b))}})};if(typeof module!="undefined"&&module.exports){module.exports=u.Promise||d}else{if(!u.Promise){u.Promise=d}}}(this));